---
globs: modules/server.js
---

# HTTP 서버 개발 패턴

## 포트 관리
- 18731-18740 범위에서 순차적으로 포트 시도
- EADDRINUSE 에러 시 다음 포트로 자동 이동
- 서버 시작 실패 시 적절한 에러 처리

## 세션 관리
- 세션 ID는 영숫자 조합으로 고유성 보장
- 세션 데이터는 홈 디렉토리 `.webprinter-sessions.json`에 저장
- 24시간 TTL로 자동 정리

## API 엔드포인트
```javascript
POST /send-urls    // 인쇄 데이터 수신
GET /status        // 서버 상태 확인  
GET /version       // 버전 정보
```

## 요청 검증
- 필수 파라미터 검증 (session, url, paper_size)
- 용지 크기 숫자 유효성 확인
- CORS 헤더 적절히 설정

## 에러 응답
항상 일관된 형태로 응답:
```javascript
{ success: false, error: "에러 메시지" }
{ success: true, data: {...} }
```