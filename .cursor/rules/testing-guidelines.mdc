---
globs: test/**/*.js,test/*.js,*.test.js
description: Testing and quality assurance guidelines
---

# WebPrinter í…ŒìŠ¤íŒ… ê°€ì´ë“œë¼ì¸

## ê¸°ë³¸ í…ŒìŠ¤íŠ¸ êµ¬ì¡°

### í˜„ì¬ êµ¬í˜„ëœ í…ŒìŠ¤íŠ¸
[test/basic.test.js](mdc:test/basic.test.js) - ê¸°ë³¸ ìœ íš¨ì„± ê²€ì‚¬:
- í•„ìˆ˜ íŒŒì¼ ì¡´ì¬ í™•ì¸
- JSON íŒŒì¼ ìœ íš¨ì„± ê²€ì¦
- ëª¨ë“ˆ ë¡œë”© í…ŒìŠ¤íŠ¸

### ê¸°ë³¸ í…ŒìŠ¤íŠ¸ íŒ¨í„´
```javascript
// âœ… ê¸°ì¡´ íŒ¨í„´ (ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸)
let failed = false;

if (condition) {
  console.log(`âœ… ${testName} ì„±ê³µ`);
} else {
  console.error(`âŒ ${testName} ì‹¤íŒ¨`);
  failed = true;
}

process.exit(failed ? 1 : 0);
```

## í™•ì¥ í…ŒìŠ¤íŠ¸ ì „ëµ

### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
```javascript
// âœ… ëª¨ë“ˆë³„ í…ŒìŠ¤íŠ¸ (Jest ì‚¬ìš© ì‹œ)
describe('Server Module', () => {
  test('í¬íŠ¸ ìë™ í• ë‹¹', async () => {
    const server = await startHttpServer();
    const port = getServerPort();
    expect(port).toBeGreaterThanOrEqual(18731);
    expect(port).toBeLessThanOrEqual(18740);
  });
});
```

### í†µí•© í…ŒìŠ¤íŠ¸
```javascript
// âœ… API ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸
const response = await fetch('http://localhost:18731/send-urls', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    session: 'test-session',
    front_preview_url: 'https://example.com',
    paper_width: 210,
    paper_height: 297
  })
});

const result = await response.json();
assert(result.success === true);
```

## í…ŒìŠ¤íŠ¸ ë²”ìœ„

### í•µì‹¬ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
- [ ] HTTP ì„œë²„ ì‹œì‘/ì¢…ë£Œ
- [ ] í¬íŠ¸ ìë™ í• ë‹¹ (18731-18740)
- [ ] í”„ë¦°í„° ëª©ë¡ ì¡°íšŒ
- [ ] PDF ìƒì„± (ë‹¨ì¼/ë‹¤ì¤‘ í˜ì´ì§€)
- [ ] ì§ì ‘ ì¸ì‡„ ê¸°ëŠ¥
- [ ] ì„¸ì…˜ ë°ì´í„° ê´€ë¦¬
- [ ] IPC í†µì‹ 

### ë°±ê·¸ë¼ìš´ë“œ ì„œë¹„ìŠ¤
- [ ] ì‹œìŠ¤í…œ íŠ¸ë ˆì´ ìƒì„±
- [ ] ìë™ ì‹œì‘ ì„¤ì •
- [ ] ì¢…ë£Œ ë°©ì§€ (ë¶ˆì‚¬ì¡° ëª¨ë“œ)
- [ ] ì„œë¹„ìŠ¤ ë³µêµ¬ ë©”ì»¤ë‹ˆì¦˜
- [ ] í”„ë¡œí† ì½œ í•¸ë“¤ë§ (webprinter://)

### ì—ëŸ¬ ì²˜ë¦¬
- [ ] ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜
- [ ] ì˜ëª»ëœ URL ì²˜ë¦¬
- [ ] í”„ë¦°í„° ì—°ê²° ì‹¤íŒ¨
- [ ] ë©”ëª¨ë¦¬ ë¶€ì¡±
- [ ] ê¶Œí•œ ì˜¤ë¥˜

## í”Œë«í¼ë³„ í…ŒìŠ¤íŠ¸

### Windows
```javascript
// ë ˆì§€ìŠ¤íŠ¸ë¦¬ í™•ì¸
const { exec } = require('child_process');
exec('reg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v WebPrinter', 
  (error, stdout) => {
    if (!error && stdout.includes('WebPrinter')) {
      console.log('âœ… Windows ìë™ ì‹œì‘ ë“±ë¡ë¨');
    }
  }
);
```

### macOS
```javascript
// ë¡œê·¸ì¸ í•­ëª© í™•ì¸
const loginItems = app.getLoginItemSettings();
if (loginItems.openAtLogin) {
  console.log('âœ… macOS ë¡œê·¸ì¸ ì‹œì‘ ì„¤ì •ë¨');
}
```

## ì„±ëŠ¥ í…ŒìŠ¤íŠ¸

### ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
```javascript
// ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ì²´í¬
const initialMemory = process.memoryUsage().heapUsed;
// ... ì‘ì—… ìˆ˜í–‰ ...
const finalMemory = process.memoryUsage().heapUsed;
const increase = (finalMemory - initialMemory) / 1024 / 1024; // MB
console.log(`ë©”ëª¨ë¦¬ ì¦ê°€: ${increase.toFixed(2)} MB`);
```

### ì‘ë‹µ ì‹œê°„
```javascript
// API ì‘ë‹µ ì‹œê°„ ì¸¡ì •
const start = Date.now();
await someAsyncOperation();
const duration = Date.now() - start;
assert(duration < 1000, '1ì´ˆ ì´ë‚´ ì‘ë‹µ í•„ìš”');
```

## ì˜ˆì œ ì• í”Œë¦¬ì¼€ì´ì…˜ í…ŒìŠ¤íŠ¸

[example/](mdc:example/) ë””ë ‰í† ë¦¬ë¥¼ í†µí•œ ì‹¤ì œ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸:

### í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤
1. example/index.html ì—´ê¸°
2. "ì¸ì‡„ í…ŒìŠ¤íŠ¸" ë²„íŠ¼ í´ë¦­
3. WebPrinter ì°½ í‘œì‹œ í™•ì¸
4. PDF ë¯¸ë¦¬ë³´ê¸° ìƒì„± í™•ì¸
5. í”„ë¦°í„°ë¡œ ì¶œë ¥ í…ŒìŠ¤íŠ¸

### ì—ëŸ¬ ì‹œë‚˜ë¦¬ì˜¤
- ì„œë²„ ë¯¸ì‹¤í–‰ ìƒíƒœì—ì„œ ìš”ì²­
- ì˜ëª»ëœ ì„¸ì…˜ ID
- ë„¤íŠ¸ì›Œí¬ ì—°ê²° ëŠê¹€
- í”„ë¦°í„° ì˜¤í”„ë¼ì¸

## ë””ë²„ê¹… ê°€ì´ë“œ

### ë¡œê¹… ì „ëµ
```javascript
// ê°œë°œ í™˜ê²½ì—ì„œë§Œ ìƒì„¸ ë¡œê·¸
if (process.env.NODE_ENV === 'development') {
  console.log('ğŸ” ìƒì„¸ ë””ë²„ê·¸ ì •ë³´:', data);
}

// ì¤‘ìš” ì´ë²¤íŠ¸ëŠ” í•­ìƒ ë¡œê·¸
console.log('ğŸš€ ì„œë²„ ì‹œì‘ë¨:', port);
console.error('âŒ ì¹˜ëª…ì  ì˜¤ë¥˜:', error);
```

### ì—ëŸ¬ ì¶”ì 
```javascript
// ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ ë³´ì¡´
try {
  await riskyOperation();
} catch (error) {
  console.error('ì‘ì—… ì‹¤íŒ¨:', error.message);
  console.error('ìŠ¤íƒ:', error.stack);
  // ì—ëŸ¬ë¥¼ ìƒìœ„ë¡œ ì „íŒŒ
  throw error;
}
```

## CI/CD í†µí•©

### GitHub Actions ì˜ˆì œ
```yaml
name: Test
on: [push, pull_request]
jobs:
  test:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-node@v2
      - run: npm install
      - run: npm test
```